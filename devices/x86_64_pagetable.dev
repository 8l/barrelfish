/*
 * Copyright (c) 2007, 2008, ETH Zurich. All rights reserved.
 *
 * This file is distributed under the terms in the attached LICENSE file.
 * If you do not find this file, copies can be found by writing to:
 * ETH Zurich D-INFK, Haldeneggsteig 4, CH-8092 Zurich. Attn: Systems Group.
 */

/*
 * x86_64_pagetable.dev
 *
 * DESCRIPTION: x86-64 pagetable format.
 * 
 * This is derived from the "Intel 64 and IA-32 Architectures Software
 * Developer's Manual", volume 3A, "System Programming Guide, Part 1",
 * chapter 3, "Protected-Mode Memory Management".
 */

device x86_64_pagetable ( ) "x86-64 pagetable" {

  //
  // Section 3.10: PAE-Enabled Paging in IA-32e Mode
  //

  regtype pdir_entry "Page-Directory Entry" {
    exb	   	1  "Execute-Disable";
    avail	11 "Available";
    _		12 mbz;
    base	28 "Base address";
    avail2	3  "Available";
    _		2  mbz;
    avail3	1  "Available";
    accessed	1  "Accessed";
    pcd		1  "Cache disabled";
    pwt		1  "Write-through";
    us		1  "User/Supervisor";
    rw		1  "Read/Write";
    present	1  "Present";
  };

  regtype ptable_entry "Page-Table Entry" {
    exb	   	1  "Execute-Disable";
    avail	11 "Available";
    _		12 mbz;
    base	28 "Base address";
    avail2	3  "Available";
    global	1  "Global";
    pat		1  "Page-Attribute index";
    dirty	1  "Dirty";
    accessed	1  "Accessed";
    pcd		1  "Cache disabled";
    pwt		1  "Write-through";
    us		1  "User/Supervisor";
    rw		1  "Read/Write";
    present	1  "Present";
  };

};
